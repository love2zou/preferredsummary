[2025-12-28 20:55:36 INF]  应用程序启动中... {}
[2025-12-28 20:55:36 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 20:55:37 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 20:55:38 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 20:55:38 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 20:55:38 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 20:55:38 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 20:55:38 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 20:55:38 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:00:00 执行 {}
[2025-12-28 20:56:02 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=13c910d5-f673-4bc4-9987-d63f1917a5f8 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:00:07 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:00:11 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 21:00:11 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 21:00:11 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 21:00:11 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 21:00:15 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 15.00GB, 估算总内存: 23.78GB, 使用率: 66.67% {}
[2025-12-28 21:00:15 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 21:00:15 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.83% {}
[2025-12-28 21:00:15 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.03%, 内存: 66.67%, 磁盘: 27.83%, 使用内存: 119528751104 {}
[2025-12-28 21:00:18 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=f4336b3d-50b8-4a28-9fc4-666a0c5fa903 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:00:18 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.03%, 内存: 66.67%, 磁盘: 27.83% {}
[2025-12-28 21:00:18 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 21:00:18 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 10.55秒 {}
[2025-12-28 21:00:18 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 21:00:18 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:05:00 执行 {}
[2025-12-28 21:01:26 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=81b7f4f3-495c-46b5-827f-c32c92f904c7 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:02:00 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=f2e10c71-4743-43e1-b1f2-b6d393197942 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:03:08 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=cfc2018f-29f7-4ffc-ba35-ace40a968a29 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:03:52 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=bcb68e5f-1959-43c4-a395-2fcc82f34fba {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:06:23 INF]  应用程序启动中... {}
[2025-12-28 21:06:24 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:06:24 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:06:25 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:06:25 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:06:25 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:06:25 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:06:25 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:06:25 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:10:00 执行 {}
[2025-12-28 21:09:41 INF]  应用程序启动中... {}
[2025-12-28 21:09:42 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:09:42 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:09:42 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:09:42 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:09:42 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:09:42 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:09:42 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:09:42 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:10:00 执行 {}
[2025-12-28 21:10:02 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:10:28 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 21:10:28 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 21:10:28 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 21:10:28 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 21:10:28 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=57420c01-5d0d-488f-a067-a6a67ea06b34 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:10:29 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 16.00GB, 估算总内存: 24.52GB, 使用率: 66.67% {}
[2025-12-28 21:10:29 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 21:10:29 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.82% {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.19%, 内存: 66.67%, 磁盘: 27.82%, 使用内存: 119491006464 {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.19%, 内存: 66.67%, 磁盘: 27.82% {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 3.09秒 {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 21:10:29 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:15:00 执行 {}
[2025-12-28 21:11:38 INF]  应用程序启动中... {}
[2025-12-28 21:11:38 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:11:39 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:11:40 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:11:40 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:11:40 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:11:40 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:11:40 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:11:40 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:15:00 执行 {}
[2025-12-28 21:21:03 INF]  应用程序启动中... {}
[2025-12-28 21:21:03 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:21:04 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:21:04 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:21:04 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:21:04 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:21:04 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:21:04 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:21:04 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:25:00 执行 {}
[2025-12-28 21:22:57 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=c9d32ae0-bcc6-45b8-a78d-1326604ae55c {}
Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: Database operation expected to affect 1 row(s) but actually affected 0 row(s). Data may have been modified or deleted since entities were loaded. See http://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ThrowAggregateUpdateConcurrencyException(Int32 commandIndex, Int32 expectedRowsAffected, Int32 rowsAffected)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithoutPropagationAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Zwav.Application.Workers.AnalysisWorker.UpdateStatusAsync(ApplicationDbContext context, ZwavAnalysis analysis, String status, Int32 progress, String errorMessage, Nullable`1 startTime, Nullable`1 finishTime, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 177
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 152
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:23:22 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=92740a00-336d-4c95-8f14-1b299950be3d {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:24:27 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=69d70b72-9e95-4aab-98cb-9f70b8446ab0 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:25:05 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:33:35 INF]  应用程序启动中... {}
[2025-12-28 21:33:35 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:33:36 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:33:36 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:33:36 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:33:36 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:33:36 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:33:36 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:33:36 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:35:00 执行 {}
[2025-12-28 21:33:49 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=1f99275b-e569-4eef-b2f6-c660608d59d0 {}
System.NullReferenceException: Object reference not set to an instance of an object.
   at Zwav.Application.Workers.AnalysisWorker.UpsertHdrAsync(ApplicationDbContext context, Int32 analysisId, HdrParseResult hdr, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 235
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 126
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:36:10 INF]  应用程序启动中... {}
[2025-12-28 21:36:11 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:36:11 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:36:12 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:36:12 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:36:12 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:36:12 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:36:12 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:36:12 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:40:00 执行 {}
[2025-12-28 21:38:22 ERR] Zwav.Application.Workers.AnalysisWorker Analysis failed. guid=af8eb712-adb8-4204-86c6-a3127625ecdd {}
Microsoft.EntityFrameworkCore.DbUpdateConcurrencyException: Database operation expected to affect 1 row(s) but actually affected 0 row(s). Data may have been modified or deleted since entities were loaded. See http://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ThrowAggregateUpdateConcurrencyException(Int32 commandIndex, Int32 expectedRowsAffected, Int32 rowsAffected)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithoutPropagationAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Zwav.Application.Workers.AnalysisWorker.UpdateStatusAsync(ApplicationDbContext context, ZwavAnalysis analysis, String status, Int32 progress, String errorMessage, Nullable`1 startTime, Nullable`1 finishTime, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 177
   at Zwav.Application.Workers.AnalysisWorker.ProcessOneAsync(String analysisGuid, CancellationToken ct) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 152
   at Zwav.Application.Workers.AnalysisWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\github\preferredsummary\api\Preferred.Api\Helper\AnalysisWorker.cs:line 45
[2025-12-28 21:40:09 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:40:37 INF]  应用程序启动中... {}
[2025-12-28 21:40:38 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:40:39 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:40:39 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:40:39 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:40:39 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:40:39 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:40:39 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:40:39 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:45:00 执行 {}
[2025-12-28 21:45:00 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:45:00 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 21:45:00 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 21:45:00 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 21:45:00 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 21:45:01 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 16.00GB, 估算总内存: 24.26GB, 使用率: 66.67% {}
[2025-12-28 21:45:01 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 21:45:01 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.84% {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.00%, 内存: 66.67%, 磁盘: 27.84%, 使用内存: 119556014080 {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.00%, 内存: 66.67%, 磁盘: 27.84% {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 1.18秒 {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 21:45:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:50:00 执行 {}
[2025-12-28 21:50:00 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 21:50:00 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 21:50:00 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 21:50:00 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 21:50:00 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 21:50:01 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 16.00GB, 估算总内存: 24.04GB, 使用率: 66.67% {}
[2025-12-28 21:50:01 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 21:50:01 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.83% {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.00%, 内存: 66.67%, 磁盘: 27.83%, 使用内存: 119546421248 {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.00%, 内存: 66.67%, 磁盘: 27.83% {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 1.13秒 {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 21:50:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 21:55:00 执行 {}
[2025-12-28 21:56:54 INF]  应用程序启动中... {}
[2025-12-28 21:56:54 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务后台服务已启动 {}
[2025-12-28 21:56:55 WRN] Microsoft.EntityFrameworkCore.Model.Validation The 'bool' property 'Enabled' on entity type 'ScheduledTask' is configured with a database-generated default. This default will always be used for inserts when the property has the value 'false', since this is the CLR default for the 'bool' type. Consider using the nullable 'bool?' type instead so that the default will only be used for inserts when the property value is 'null'. {"EventId":{"Id":20601,"Name":"Microsoft.EntityFrameworkCore.Model.Validation.BoolWithDefaultWarning"}}
[2025-12-28 21:56:56 INF] Microsoft.Hosting.Lifetime Now listening on: http://localhost:5000 {}
[2025-12-28 21:56:56 INF] Microsoft.Hosting.Lifetime Now listening on: https://localhost:5001 {}
[2025-12-28 21:56:56 INF] Microsoft.Hosting.Lifetime Application started. Press Ctrl+C to shut down. {}
[2025-12-28 21:56:56 INF] Microsoft.Hosting.Lifetime Hosting environment: Development {}
[2025-12-28 21:56:56 INF] Microsoft.Hosting.Lifetime Content root path: D:\github\preferredsummary\api\Preferred.Api {}
[2025-12-28 21:56:56 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 22:00:00 执行 {}
[2025-12-28 22:00:00 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 22:00:00 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 22:00:00 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 22:00:00 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 22:00:00 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 22:00:01 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 16.00GB, 估算总内存: 24.23GB, 使用率: 66.67% {}
[2025-12-28 22:00:01 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 22:00:01 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.89% {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.00%, 内存: 66.67%, 磁盘: 27.89%, 使用内存: 119772733440 {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.00%, 内存: 66.67%, 磁盘: 27.89% {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 1.18秒 {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 22:00:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 22:05:00 执行 {}
[2025-12-28 22:04:59 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 开始执行定时任务: 1 {}
[2025-12-28 22:05:00 INF] Preferred.Api.Services.ScheduledTaskService 开始手动执行定时任务: 系统资源监控 (SYSTEM_RESOURCE_MONITOR) {}
[2025-12-28 22:05:00 INF] Preferred.Api.Services.ScheduledTaskService 执行系统监控任务: 系统资源监控 {}
[2025-12-28 22:05:00 INF] Preferred.Api.Services.SystemMonitorService 系统监控服务已初始化 - 操作系统: Windows {}
[2025-12-28 22:05:00 INF] Preferred.Api.Services.SystemMonitorService 开始执行系统资源监控... {}
[2025-12-28 22:05:01 DBG] Preferred.Api.Services.SystemMonitorService 进程估算内存使用率 - 进程总内存: 16.00GB, 估算总内存: 24.80GB, 使用率: 66.67% {}
[2025-12-28 22:05:01 DBG] Preferred.Api.Services.SystemMonitorService 尝试获取Windows磁盘使用情况: C:\ {}
[2025-12-28 22:05:01 DBG] Preferred.Api.Services.SystemMonitorService 磁盘 C:\ - 总计: 400.00GB, 已用: 111.00GB, 使用率: 27.89% {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控 - 配置磁盘: auto, 实际监控: C:\, CPU: 0.10%, 内存: 66.67%, 磁盘: 27.89%, 使用内存: 119785955328 {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.SystemMonitorService 系统资源监控数据保存成功 - CPU: 0.10%, 内存: 66.67%, 磁盘: 27.89% {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.ScheduledTaskService 系统监控任务执行完成: 系统资源监控 {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.ScheduledTaskService 手动执行定时任务成功: 系统资源监控 (SYSTEM_RESOURCE_MONITOR), 耗时: 1.14秒 {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务执行完成: 1, 结果: 成功 {}
[2025-12-28 22:05:01 INF] Preferred.Api.Services.ScheduledTaskBackgroundService 定时任务 系统资源监控 已安排在 2025-12-28 22:10:00 执行 {}
